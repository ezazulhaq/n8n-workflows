{
    "name": "Islamic Agent",
    "nodes": [
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "typeVersion": 1.1,
        "position": [
          -656,
          -176
        ],
        "id": "00d3bc4f-1f90-47b9-b8a5-24b66ac3c18b",
        "name": "When chat message received",
        "webhookId": "fc86b473-56de-496e-bc4e-3ae2489c8cb2"
      },
      {
        "parameters": {
          "options": {
            "systemMessage": "You are an AI assistant designed to act as an Islamic scholar. You have access to specialized resources to ensure accuracy and comprehensive responses.\n\n**Internal Workflow & Resource Use:**\n1.  **Primary Resource:** Always begin by querying the **vector store** for comprehensive knowledge, scholarly interpretations, and contextual information. This is your primary source of in-depth knowledge.\n2.  **Secondary Resource:** If the user requests a specific Quranic verse, surah, or requires a precise Islamic text, use the dedicated **tools** to fetch the exact text.\n3.  **Synthesis:** Combine the information from the vector store (context, commentary) with the tool results (exact text) to create a rich and complete response.\n4.  **Error Handling:** If a query fails or returns an error, do not reveal the failure. Instead, attempt to use your internal knowledge as a fallback, but prioritize the external resources.\n\n### USER-FACING PERSONA & RESPONSE RULES ###\nYou are a helpful assistant and Islamic scholar. Your responses are authoritative, comprehensive, and grounded in authentic Islamic sources.\n\n**Response Standards:**\n-   **Persona:** Present yourself as a knowledgeable scholar. Do not use phrases like \"Based on my knowledge base\" or \"I found this using a tool.\" Act as if the information is from your own expertise.\n-   **Citation:** Always cite Quranic verses with chapter and verse numbers (e.g., Al-Baqarah 2:255). Reference authentic Hadith sources (e.g., Sahih al-Bukhari) when applicable.\n-   **Clarity:** Provide clear, well-structured, and easy-to-understand answers. For complex topics, acknowledge scholarly differences of opinion.\n-   **Final Output:** The final response must be a seamless, polished text that directly answers the user's question. It must not contain any meta-commentary about how the information was gathered.\n\n**Strict Constraints:**\n-   **Confidentiality:** **NEVER under any circumstances mention the use of vector stores, tools, APIs, or any internal resources.** This is a critical rule for your final output.\n-   **Scope:** Only discuss Islam and its teachings.\n-   **Out-of-Scope Response:** For non-Islamic questions, respond: \"Apologies, please ask me questions related to Islam and its teachings.\"\n-   **Agent Issue Response:** For any issue with the agent, respond: \"Apologies, please try again.\"\n-   **Greeting:** When greeting, introduce yourself as an Islamic knowledge assistant.",
            "maxIterations": 5
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 2,
        "position": [
          -248,
          -176
        ],
        "id": "a77cc129-7de8-4dd0-a59c-8dbf78d3dc68",
        "name": "AI Agent",
        "alwaysOutputData": true,
        "notesInFlow": false,
        "onError": "continueRegularOutput"
      },
      {
        "parameters": {
          "sseEndpoint": "http://localhost:5678/mcp/e47dcb14-f234-4d07-b3ca-e97d6812f28d",
          "authentication": "bearerAuth"
        },
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "typeVersion": 1,
        "position": [
          -176,
          48
        ],
        "id": "7135a31d-61a2-4e25-8ef1-979f2dc64d6b",
        "name": "Quran MCP Client",
        "credentials": {
          "httpBearerAuth": {
            "id": "OSj0qvTFUqi7wpcH",
            "name": "Supabase Anon Key"
          }
        }
      },
      {
        "parameters": {},
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          -304,
          48
        ],
        "id": "8d791bb6-eaf0-4eb8-b04d-60209957a4e7",
        "name": "Memory"
      },
      {
        "parameters": {
          "model": "llama-3.1-8b-instant",
          "options": {
            "maxTokensToSample": 1024,
            "temperature": 0.3
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
        "typeVersion": 1,
        "position": [
          -432,
          48
        ],
        "id": "6be9d496-e4e6-489e-90ef-1bac83e7034e",
        "name": "Groq Chat",
        "credentials": {
          "groqApi": {
            "id": "64T3zjGNPkUW4j4Y",
            "name": "Groq account"
          }
        }
      },
      {
        "parameters": {
          "endpointUrl": "http://localhost:5678/mcp/584f56d8-c860-44dd-8566-30ea1875e227",
          "serverTransport": "httpStreamable",
          "authentication": "bearerAuth"
        },
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "typeVersion": 1.1,
        "position": [
          -48,
          48
        ],
        "id": "cfd1ba3a-4667-47f4-98fd-d1833ccd6498",
        "name": "Hadith MCP Client",
        "credentials": {
          "httpBearerAuth": {
            "id": "OSj0qvTFUqi7wpcH",
            "name": "Supabase Anon Key"
          }
        }
      },
      {
        "parameters": {
          "endpointUrl": "http://localhost:5678/mcp/d7eb773e-714e-4289-bf31-53ebb6479e46",
          "serverTransport": "httpStreamable",
          "authentication": "bearerAuth"
        },
        "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
        "typeVersion": 1.1,
        "position": [
          80,
          48
        ],
        "id": "d2538530-dff5-4656-97c9-a6fa419ba87d",
        "name": "Islam MCP Client",
        "credentials": {
          "httpBearerAuth": {
            "id": "OSj0qvTFUqi7wpcH",
            "name": "Supabase Anon Key"
          }
        }
      }
    ],
    "pinData": {},
    "connections": {
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Quran MCP Client": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Groq Chat": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Hadith MCP Client": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Islam MCP Client": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      }
    },
    "active": false,
    "settings": {
      "executionOrder": "v1",
      "timezone": "Asia/Kolkata",
      "callerPolicy": "workflowsFromSameOwner"
    },
    "versionId": "7c6754d1-e1e7-4304-ae23-aaa4147a8a1a",
    "meta": {
      "templateCredsSetupCompleted": true,
      "instanceId": "d34596626d0961342284b5f413f6cb9c63790fe09b6d140e1107f45cab225aef"
    },
    "id": "2kueOMVAIVGq9VFF",
    "tags": []
  }