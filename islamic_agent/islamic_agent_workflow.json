{
    "name": "Islamic Agent",
    "nodes": [
        {
            "parameters": {
                "public": true,
                "options": {
                    "allowedOrigins": "*",
                    "subtitle": "Start a chat. We're here to help you 24/7.",
                    "title": "The Taqwa Tracker"
                }
            },
            "type": "@n8n/n8n-nodes-langchain.chatTrigger",
            "typeVersion": 1.1,
            "position": [
                -128,
                -176
            ],
            "id": "00d3bc4f-1f90-47b9-b8a5-24b66ac3c18b",
            "name": "When chat message received",
            "webhookId": "fc86b473-56de-496e-bc4e-3ae2489c8cb2"
        },
        {
            "parameters": {
                "options": {
                    "systemMessage": "You are a helpful assistant and Islamic scholar specializing in Quranic and Hadith teachings.\n\n**DUAL APPROACH - Tools + Vector Store:**\n- You have TWO important resources: specific tools for fetching surahs/ayahs AND a comprehensive vector store\n- ALWAYS use BOTH resources to provide complete and accurate responses\n- Tools give you exact Quranic text, vector store provides contextual knowledge and commentary\n\n**Response Workflow:**\n1. **First**: Use tools to fetch requested specific surahs, ayahs, or Islamic texts\n2. **Second**: Query vector store for contextual information, scholarly interpretations, and related teachings\n3. **Then**: Combine both sources to provide comprehensive responses\n\n**When to use each resource:**\n**Tools:**\n- Exact Quranic verses or surahs requested\n- Specific ayah numbers or chapters\n- When precise Islamic text is needed\n\n**Vector Store:**\n- Contextual explanations and interpretations\n- Related Islamic teachings and concepts\n- Historical context and scholarly commentary\n- Cross-references to other verses or Hadith\n\n**Response Standards:**\n- Always cite Quranic verses with chapter and verse numbers\n- Reference authentic Hadith sources when applicable\n- Combine tool results with vector store insights for rich, comprehensive answers\n- Acknowledge when topics have scholarly differences of opinion\n\n**Strict Context:**\n- Only discuss Islam and its teachings\n- For non-Islamic questions, respond: \"Apologies, please ask me questions related to Islam and its teachings\"\n- When greeting, introduce yourself as an Islamic knowledge assistant\n\n**Example Response Pattern:**\n1. Use tool to get specific verse text\n2. Use vector store to get explanation/context\n3. Provide combined response with both exact text and scholarly insight",
                    "maxIterations": 5
                }
            },
            "type": "@n8n/n8n-nodes-langchain.agent",
            "typeVersion": 2,
            "position": [
                256,
                -176
            ],
            "id": "a77cc129-7de8-4dd0-a59c-8dbf78d3dc68",
            "name": "AI Agent",
            "alwaysOutputData": true,
            "onError": "continueRegularOutput"
        },
        {
            "parameters": {
                "model": "llama-3.1-8b-instant",
                "options": {
                    "maxTokensToSample": 512,
                    "temperature": 0.3
                }
            },
            "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
            "typeVersion": 1,
            "position": [
                96,
                48
            ],
            "id": "6be9d496-e4e6-489e-90ef-1bac83e7034e",
            "name": "Groq Chat Model",
            "credentials": {
                "groqApi": {
                    "id": "64T3zjGNPkUW4j4Y",
                    "name": "Groq account"
                }
            }
        },
        {
            "parameters": {},
            "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
            "typeVersion": 1.3,
            "position": [
                224,
                48
            ],
            "id": "8d791bb6-eaf0-4eb8-b04d-60209957a4e7",
            "name": "Simple Memory"
        },
        {
            "parameters": {},
            "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
            "typeVersion": 1,
            "position": [
                704,
                256
            ],
            "id": "70e9a2ed-6667-412e-bd4c-4a17d6e60363",
            "name": "Embeddings Google Gemini1",
            "credentials": {
                "googlePalmApi": {
                    "id": "gGqeo8g2DGaUXqOJ",
                    "name": "Google Gemini(PaLM) Api account"
                }
            }
        },
        {
            "parameters": {
                "description": "Call this tool to get all the Ayah based on Surah number as input or even mentioned about Surah",
                "workflowId": {
                    "__rl": true,
                    "value": "yfJI2Nx9YWpcznc2",
                    "mode": "list",
                    "cachedResultName": "Get All Ayahs of Surah"
                },
                "workflowInputs": {
                    "mappingMode": "defineBelow",
                    "value": {
                        "surah_id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('surah_id', ``, 'number') }}"
                    },
                    "matchingColumns": [
                        "surah_id"
                    ],
                    "schema": [
                        {
                            "id": "surah_id",
                            "displayName": "surah_id",
                            "required": false,
                            "defaultMatch": false,
                            "display": true,
                            "canBeUsedToMatch": true,
                            "type": "string",
                            "removed": false
                        }
                    ],
                    "attemptToConvertTypes": false,
                    "convertFieldsToString": false
                }
            },
            "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
            "typeVersion": 2.2,
            "position": [
                352,
                48
            ],
            "id": "b9a065c8-9fc8-4216-90a7-c00593fc4c0c",
            "name": "Get Ayahs"
        },
        {
            "parameters": {
                "description": "Call this tool if any specific Ayah of a Surah is requested in the formats like\n1. Verse (Surah):(Ayah)\n2. Surah (number) and Ayah (number)\n3. Surah (name), Ayah (number)",
                "workflowId": {
                    "__rl": true,
                    "value": "owrGoln2UMtickrP",
                    "mode": "list",
                    "cachedResultName": "Get One Ayah"
                },
                "workflowInputs": {
                    "mappingMode": "defineBelow",
                    "value": {
                        "surah_id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('surah_id', ``, 'number') }}",
                        "ayah_number": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('ayah_number', ``, 'number') }}"
                    },
                    "matchingColumns": [],
                    "schema": [
                        {
                            "id": "surah_id",
                            "displayName": "surah_id",
                            "required": false,
                            "defaultMatch": false,
                            "display": true,
                            "canBeUsedToMatch": true,
                            "type": "number"
                        },
                        {
                            "id": "ayah_number",
                            "displayName": "ayah_number",
                            "required": false,
                            "defaultMatch": false,
                            "display": true,
                            "canBeUsedToMatch": true,
                            "type": "number"
                        }
                    ],
                    "attemptToConvertTypes": false,
                    "convertFieldsToString": false
                }
            },
            "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
            "typeVersion": 2.2,
            "position": [
                480,
                48
            ],
            "id": "1a628524-2f4f-484e-9a5a-efa40f731741",
            "name": "Get Specific Ayah"
        },
        {
            "parameters": {
                "mode": "retrieve-as-tool",
                "toolDescription": "=Call this tool when asked to get any information from Quran",
                "tableName": {
                    "__rl": true,
                    "value": "quran_documents",
                    "mode": "list",
                    "cachedResultName": "quran_documents"
                },
                "topK": 5,
                "options": {
                    "queryName": "match_quran_documents"
                }
            },
            "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
            "typeVersion": 1.3,
            "position": [
                608,
                48
            ],
            "id": "ca0bccbb-31cd-4a04-b325-c86f5510b799",
            "name": "Quran Vector Store",
            "credentials": {
                "supabaseApi": {
                    "id": "RU56QCQQYWxsaqaG",
                    "name": "Supabase account"
                }
            }
        }
    ],
    "pinData": {},
    "connections": {
        "When chat message received": {
            "main": [
                [
                    {
                        "node": "AI Agent",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Groq Chat Model": {
            "ai_languageModel": [
                [
                    {
                        "node": "AI Agent",
                        "type": "ai_languageModel",
                        "index": 0
                    }
                ]
            ]
        },
        "Simple Memory": {
            "ai_memory": [
                [
                    {
                        "node": "AI Agent",
                        "type": "ai_memory",
                        "index": 0
                    }
                ]
            ]
        },
        "Embeddings Google Gemini1": {
            "ai_embedding": [
                [
                    {
                        "node": "Quran Vector Store",
                        "type": "ai_embedding",
                        "index": 0
                    }
                ]
            ]
        },
        "Get Ayahs": {
            "ai_tool": [
                [
                    {
                        "node": "AI Agent",
                        "type": "ai_tool",
                        "index": 0
                    }
                ]
            ]
        },
        "Get Specific Ayah": {
            "ai_tool": [
                [
                    {
                        "node": "AI Agent",
                        "type": "ai_tool",
                        "index": 0
                    }
                ]
            ]
        },
        "Quran Vector Store": {
            "ai_tool": [
                [
                    {
                        "node": "AI Agent",
                        "type": "ai_tool",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "active": false,
    "settings": {
        "executionOrder": "v1",
        "timezone": "Asia/Kolkata",
        "callerPolicy": "workflowsFromSameOwner"
    },
    "versionId": "c81694d8-b4da-4748-a142-1f293e2706cf",
    "meta": {
        "templateCredsSetupCompleted": true,
        "instanceId": "d34596626d0961342284b5f413f6cb9c63790fe09b6d140e1107f45cab225aef"
    },
    "id": "2kueOMVAIVGq9VFF",
    "tags": []
}